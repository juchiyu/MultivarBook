<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Partial Least Squares (PLS) | Multivariate Cookbook</title>
  <meta name="description" content="This book provides an introduction of simple and advanced multivariate analysis." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Partial Least Squares (PLS) | Multivariate Cookbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides an introduction of simple and advanced multivariate analysis." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Partial Least Squares (PLS) | Multivariate Cookbook" />
  
  <meta name="twitter:description" content="This book provides an introduction of simple and advanced multivariate analysis." />
  

<meta name="author" content="Ju-Chi Yu and Sheila Meldrum" />


<meta name="date" content="2020-02-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="correspondence-analysis-ca.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Table of Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-are-multivariate-analyses"><i class="fa fa-check"></i>What are Multivariate Analyses?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#multivariate-vs.univariate-analyses"><i class="fa fa-check"></i>Multivariate vs. Univariate Analyses</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#when-to-use-univariate-analyses"><i class="fa fa-check"></i>When to Use Univariate Analyses?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#when-to-use-multivariate-techniques"><i class="fa fa-check"></i>When to Use Multivariate Techniques?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#common-multivariate-analyses"><i class="fa fa-check"></i>Common Multivariate Analyses</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-will-this-book-cover"><i class="fa fa-check"></i>What Will this Book Cover?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#how-will-this-book-be-covered"><i class="fa fa-check"></i>How Will this Book be Covered?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1</b> Packages</a><ul>
<li class="chapter" data-level="1.1" data-path="packages.html"><a href="packages.html#functions"><i class="fa fa-check"></i><b>1.1</b> Functions</a><ul>
<li class="chapter" data-level="1.1.1" data-path="packages.html"><a href="packages.html#plot_eig"><i class="fa fa-check"></i><b>1.1.1</b> plot_eig()</a></li>
<li class="chapter" data-level="1.1.2" data-path="packages.html"><a href="packages.html#plot_pairs_all"><i class="fa fa-check"></i><b>1.1.2</b> plot_pairs_all()</a></li>
<li class="chapter" data-level="1.1.3" data-path="packages.html"><a href="packages.html#plot_contributions_all"><i class="fa fa-check"></i><b>1.1.3</b> plot_contributions_all()</a></li>
<li class="chapter" data-level="1.1.4" data-path="packages.html"><a href="packages.html#plot_latents_all"><i class="fa fa-check"></i><b>1.1.4</b> plot_latents_all()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>2</b> Datasets</a><ul>
<li class="chapter" data-level="2.1" data-path="datasets.html"><a href="datasets.html#wine"><i class="fa fa-check"></i><b>2.1</b> Wine</a></li>
<li class="chapter" data-level="2.2" data-path="datasets.html"><a href="datasets.html#ucla"><i class="fa fa-check"></i><b>2.2</b> UCLA</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html"><i class="fa fa-check"></i><b>3</b> Principal Component Analysis (PCA)</a><ul>
<li class="chapter" data-level="3.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#description"><i class="fa fa-check"></i><b>3.1</b> Description</a><ul>
<li class="chapter" data-level="3.1.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#pca_intro"><i class="fa fa-check"></i><b>3.1.1</b> What is PCA?</a></li>
<li class="chapter" data-level="3.1.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#singular-value-decomposition-svd"><i class="fa fa-check"></i><b>3.1.2</b> Singular Value Decomposition (SVD)</a></li>
<li class="chapter" data-level="3.1.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#how-to-interpret-these-matrices"><i class="fa fa-check"></i><b>3.1.3</b> How to Interpret these Matrices?</a></li>
<li class="chapter" data-level="3.1.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#what-are-the-assumptions-of-pca"><i class="fa fa-check"></i><b>3.1.4</b> What are the Assumptions of PCA?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#example"><i class="fa fa-check"></i><b>3.2</b> Example</a><ul>
<li class="chapter" data-level="3.2.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#packages-1"><i class="fa fa-check"></i><b>3.2.1</b> Packages</a></li>
<li class="chapter" data-level="3.2.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#data-pre-processing"><i class="fa fa-check"></i><b>3.2.2</b> Data Pre-Processing</a></li>
<li class="chapter" data-level="3.2.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.2.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.2.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#analysis"><i class="fa fa-check"></i><b>3.2.4</b> Analysis</a></li>
<li class="chapter" data-level="3.2.5" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#number-of-components"><i class="fa fa-check"></i><b>3.2.5</b> Number of Components</a></li>
<li class="chapter" data-level="3.2.6" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#visualize-and-interpret-components"><i class="fa fa-check"></i><b>3.2.6</b> Visualize and Interpret Components</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#behind-the-scenes"><i class="fa fa-check"></i><b>3.3</b> Behind-the-Scenes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#svd"><i class="fa fa-check"></i><b>3.3.1</b> SVD</a></li>
<li class="chapter" data-level="3.3.2" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#svd-results"><i class="fa fa-check"></i><b>3.3.2</b> SVD Results</a></li>
<li class="chapter" data-level="3.3.3" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#projections"><i class="fa fa-check"></i><b>3.3.3</b> Projections</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="principal-component-analysis-pca.html"><a href="principal-component-analysis-pca.html#math-walk-through"><i class="fa fa-check"></i><b>3.4</b> Math Walk-Through</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="correspondence-analysis-ca.html"><a href="correspondence-analysis-ca.html"><i class="fa fa-check"></i><b>4</b> Correspondence Analysis (CA)</a><ul>
<li class="chapter" data-level="4.1" data-path="correspondence-analysis-ca.html"><a href="correspondence-analysis-ca.html#description-1"><i class="fa fa-check"></i><b>4.1</b> Description</a></li>
<li class="chapter" data-level="4.2" data-path="correspondence-analysis-ca.html"><a href="correspondence-analysis-ca.html#example-1"><i class="fa fa-check"></i><b>4.2</b> Example</a></li>
<li class="chapter" data-level="4.3" data-path="correspondence-analysis-ca.html"><a href="correspondence-analysis-ca.html#behind-the-scenes-1"><i class="fa fa-check"></i><b>4.3</b> Behind-the-Scenes</a></li>
<li class="chapter" data-level="4.4" data-path="correspondence-analysis-ca.html"><a href="correspondence-analysis-ca.html#math-walk-through-1"><i class="fa fa-check"></i><b>4.4</b> Math Walk-Through</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html"><i class="fa fa-check"></i><b>5</b> Partial Least Squares (PLS)</a><ul>
<li class="chapter" data-level="5.1" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#description-2"><i class="fa fa-check"></i><b>5.1</b> Description</a><ul>
<li class="chapter" data-level="5.1.1" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#what-is-pls"><i class="fa fa-check"></i><b>5.1.1</b> What is PLS?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#example-2"><i class="fa fa-check"></i><b>5.2</b> Example</a><ul>
<li class="chapter" data-level="5.2.1" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#data"><i class="fa fa-check"></i><b>5.2.1</b> Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#analysis-1"><i class="fa fa-check"></i><b>5.2.2</b> Analysis</a></li>
<li class="chapter" data-level="5.2.3" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#eigenvalue"><i class="fa fa-check"></i><b>5.2.3</b> Eigenvalue</a></li>
<li class="chapter" data-level="5.2.4" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#factor-scores-2"><i class="fa fa-check"></i><b>5.2.4</b> Factor Scores</a></li>
<li class="chapter" data-level="5.2.5" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#latent-scores"><i class="fa fa-check"></i><b>5.2.5</b> Latent Scores</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#behind-the-scenes-2"><i class="fa fa-check"></i><b>5.3</b> Behind-the-Scenes</a><ul>
<li class="chapter" data-level="5.3.1" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#wrangling"><i class="fa fa-check"></i><b>5.3.1</b> Wrangling</a></li>
<li class="chapter" data-level="5.3.2" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#sum-of-cross-products"><i class="fa fa-check"></i><b>5.3.2</b> Sum of Cross Products</a></li>
<li class="chapter" data-level="5.3.3" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#pca"><i class="fa fa-check"></i><b>5.3.3</b> PCA</a></li>
<li class="chapter" data-level="5.3.4" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#eigenvalue-1"><i class="fa fa-check"></i><b>5.3.4</b> Eigenvalue</a></li>
<li class="chapter" data-level="5.3.5" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#factor-scores-3"><i class="fa fa-check"></i><b>5.3.5</b> Factor Scores</a></li>
<li class="chapter" data-level="5.3.6" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#latent-scores-1"><i class="fa fa-check"></i><b>5.3.6</b> Latent Scores</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="partial-least-squares-pls.html"><a href="partial-least-squares-pls.html#math-walk-through-2"><i class="fa fa-check"></i><b>5.4</b> Math Walk-Through</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="partial-least-squares-pls" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Partial Least Squares (PLS)</h1>
<div id="description-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Description</h2>
<div id="what-is-pls" class="section level3">
<h3><span class="header-section-number">5.1.1</span> What is PLS?</h3>
<p>Partial Least Squares (PLS) is used to analyze two tables of quantitative. PLS is essentially “data wrangling” followed by PCA.</p>
<p><br>
Data wrangling can include centering and/or scaling of each column of each dataset and then the cross product of the two datasets.</p>
<p><span class="math display">\[SCP = X&#39;Y\]</span></p>
<p>where <span class="math inline">\(SCP\)</span> is the sum of cross product, <span class="math inline">\(X&#39;\)</span> is the transposed matrix of the first dataset, <span class="math inline">\(Y\)</span> is the matrix of the second dataset.</p>
<p>We can then obtain the latent variables by multiplying each dataset by its respective singular value.</p>
<p><span class="math display">\[ L_X = Xu \]</span>
<span class="math display">\[ L_Y = Yv \]</span></p>
<p>The maximum possible number of latent variables is always the least number of columns of either table.</p>
<p><br></p>
</div>
</div>
<div id="example-2" class="section level2">
<h2><span class="header-section-number">5.2</span> Example</h2>
<p><br></p>
<div id="data" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Data</h3>
<p>Let’s use the UCLA dataset.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">data &lt;-<span class="st"> </span>data_ucla <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(locus_of_control<span class="op">:</span>science)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">head</span>(data)</a></code></pre></div>
<pre><code>##   locus_of_control self_concept motivation read write math science
## 1            -0.84        -0.24       1.00 54.8  64.5 44.5    52.6
## 2            -0.38        -0.47       0.67 62.7  43.7 44.7    52.6
## 3             0.89         0.59       0.67 60.6  56.7 70.5    58.0
## 4             0.71         0.28       0.67 62.7  56.7 54.7    58.0
## 5            -0.64         0.03       1.00 41.6  46.3 38.4    36.3
## 6             1.11         0.90       0.33 62.7  64.5 61.4    58.0</code></pre>
<p><br></p>
<div id="descriptive-statistics-1" class="section level4">
<h4><span class="header-section-number">5.2.1.1</span> Descriptive Statistics</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">summary</span>(data)</a></code></pre></div>
<pre><code>##  locus_of_control    self_concept         motivation          read          write      
##  Min.   :-2.23000   Min.   :-2.620000   Min.   :0.0000   Min.   :28.3   Min.   :25.50  
##  1st Qu.:-0.37250   1st Qu.:-0.300000   1st Qu.:0.3300   1st Qu.:44.2   1st Qu.:44.30  
##  Median : 0.21000   Median : 0.030000   Median :0.6700   Median :52.1   Median :54.10  
##  Mean   : 0.09653   Mean   : 0.004917   Mean   :0.6608   Mean   :51.9   Mean   :52.38  
##  3rd Qu.: 0.51000   3rd Qu.: 0.440000   3rd Qu.:1.0000   3rd Qu.:60.1   3rd Qu.:59.90  
##  Max.   : 1.36000   Max.   : 1.190000   Max.   :1.0000   Max.   :76.0   Max.   :67.10  
##       math          science     
##  Min.   :31.80   Min.   :26.00  
##  1st Qu.:44.50   1st Qu.:44.40  
##  Median :51.30   Median :52.60  
##  Mean   :51.85   Mean   :51.76  
##  3rd Qu.:58.38   3rd Qu.:58.65  
##  Max.   :75.50   Max.   :74.20</code></pre>
<p><br></p>
</div>
<div id="correlation-matrix" class="section level4">
<h4><span class="header-section-number">5.2.1.2</span> Correlation Matrix</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">correlate</span>(data) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">rplot</span>(<span class="dt">colours =</span> <span class="kw">rev</span>(RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;RdBu&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">angle =</span> <span class="dv">45</span>))</a></code></pre></div>
<pre><code>## 
## Correlation method: &#39;pearson&#39;
## Missing treated using: &#39;pairwise.complete.obs&#39;</code></pre>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type noquote. Defaulting to continuous.</code></pre>
<p><img src="Multivariate_Bookdown_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>We can see that the personality measures are weakly correlated with each other, while the standardized tests are highly correlated with each other. Also, we can see that Locus of Control is moderately correlated with each of the standardized tests.</p>
</div>
<div id="split" class="section level4">
<h4><span class="header-section-number">5.2.1.3</span> Split</h4>
<p>Let’s split the data into a dataset of personality metrics (<span class="math inline">\(X\)</span>) and another dataset of the standardized tests (<span class="math inline">\(Y\)</span>).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">X &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(locus_of_control, self_concept, motivation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="kw">head</span>(X)</a></code></pre></div>
<pre><code>##      locus_of_control self_concept motivation
## [1,]            -0.84        -0.24       1.00
## [2,]            -0.38        -0.47       0.67
## [3,]             0.89         0.59       0.67
## [4,]             0.71         0.28       0.67
## [5,]            -0.64         0.03       1.00
## [6,]             1.11         0.90       0.33</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">Y &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(read, write, math, science) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">as.matrix</span>()</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="kw">head</span>(Y)</a></code></pre></div>
<pre><code>##      read write math science
## [1,] 54.8  64.5 44.5    52.6
## [2,] 62.7  43.7 44.7    52.6
## [3,] 60.6  56.7 70.5    58.0
## [4,] 62.7  56.7 54.7    58.0
## [5,] 41.6  46.3 38.4    36.3
## [6,] 62.7  64.5 61.4    58.0</code></pre>
<p><br></p>
</div>
</div>
<div id="analysis-1" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Analysis</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">model_pls &lt;-<span class="st"> </span><span class="kw">tepPLS</span>(X, Y, <span class="dt">scale1 =</span> <span class="ot">TRUE</span>, <span class="dt">scale2 =</span> <span class="ot">TRUE</span>, <span class="dt">graphs =</span> F)</a></code></pre></div>
<p><br></p>
</div>
<div id="eigenvalue" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Eigenvalue</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">eig &lt;-<span class="st"> </span>model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>pdq<span class="op">$</span>Dv<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">plot_eig</span>(eig)</a></code></pre></div>
<p><img src="Multivariate_Bookdown_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="factor-scores-2" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Factor Scores</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>fi</a></code></pre></div>
<pre><code>##                        [,1]      [,2]      [,3]
## locus_of_control -417.77812  19.01029  2.663535
## self_concept      -59.30769  25.96956 -6.641973
## motivation       -236.51229 -40.09212 -3.039363</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">plot_pairs_all</span>(model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>fi)</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(y)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(data_x)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(data_y)`</code></pre>
<p><img src="Multivariate_Bookdown_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>fj</a></code></pre></div>
<pre><code>##              [,1]        [,2]      [,3]
## read    -259.3939   2.7145460 -3.697377
## write   -261.5493 -33.3908501  4.156636
## math    -235.5306  -0.1749094 -3.881711
## science -206.9447  38.9979374  3.798954</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">plot_pairs_all</span>(model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>fj)</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(y)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(data_x)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(data_y)`</code></pre>
<p><img src="Multivariate_Bookdown_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<p><br></p>
</div>
<div id="latent-scores" class="section level3">
<h3><span class="header-section-number">5.2.5</span> Latent Scores</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>lx <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]
## [1,]  0.7654400 -1.4637130 -0.56896322
## [2,]  0.6834717 -0.6237667  0.32105270
## [3,] -1.1371420  0.8357669 -0.31337608
## [4,] -0.8513383  0.5145176 -0.03000207
## [5,]  0.4608174 -1.1600693 -0.79367985
## [6,] -0.9894445  1.9526936 -0.18849546</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">model_pls<span class="op">$</span>TExPosition.Data<span class="op">$</span>ly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]
## [1,] -0.4841143 -0.7257935  0.96134526
## [2,]  0.2425046  0.7043251 -0.56442103
## [3,] -1.9410240  0.2379724 -0.84734860
## [4,] -1.2353508  0.2546568 -0.10831869
## [5,]  2.2621597 -0.8511297  0.08521605
## [6,] -2.0154595 -0.2686033 -0.03488452</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="co">#plot_all_latents(model_pls$TExPosition.Data$lx, model_pls$TExPosition.Data$ly)</span></a></code></pre></div>
</div>
</div>
<div id="behind-the-scenes-2" class="section level2">
<h2><span class="header-section-number">5.3</span> Behind-the-Scenes</h2>
<p><br></p>
<div id="wrangling" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Wrangling</h3>
<p>Let’s center and scale (i.e., z-score) each column in each dataset.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">X &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, scale)</a>
<a class="sourceLine" id="cb69-2" data-line-number="2">Y &lt;-<span class="st"> </span><span class="kw">apply</span>(Y, <span class="dv">2</span>, scale)</a>
<a class="sourceLine" id="cb69-3" data-line-number="3"></a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="kw">summary</span>(X)</a></code></pre></div>
<pre><code>##  locus_of_control   self_concept        motivation      
##  Min.   :-3.4710   Min.   :-3.72058   Min.   :-1.92815  
##  1st Qu.:-0.6998   1st Qu.:-0.43219   1st Qu.:-0.96529  
##  Median : 0.1693   Median : 0.03555   Median : 0.02675  
##  Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.00000  
##  3rd Qu.: 0.6169   3rd Qu.: 0.61669   3rd Qu.: 0.98960  
##  Max.   : 1.8850   Max.   : 1.67975   Max.   : 0.98960</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">summary</span>(Y)</a></code></pre></div>
<pre><code>##       read              write              math             science       
##  Min.   :-2.33613   Min.   :-2.7641   Min.   :-2.12953   Min.   :-2.6543  
##  1st Qu.:-0.76233   1st Qu.:-0.8312   1st Qu.:-0.78058   1st Qu.:-0.7586  
##  Median : 0.01961   Median : 0.1763   Median :-0.05831   Median : 0.0862  
##  Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.: 0.81146   3rd Qu.: 0.7727   3rd Qu.: 0.69317   3rd Qu.: 0.7095  
##  Max.   : 2.38525   Max.   : 1.5129   Max.   : 2.51213   Max.   : 2.3116</code></pre>
<p><br></p>
</div>
<div id="sum-of-cross-products" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Sum of Cross Products</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">scp &lt;-<span class="st"> </span><span class="kw">crossprod</span>(X, Y) <span class="co"># this is slightly faster than t(X) %*% Y</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2">scp</a></code></pre></div>
<pre><code>##                       read     write      math   science
## locus_of_control 223.76546 214.96723 202.02413 194.45154
## self_concept      36.33285  11.64969  32.10502  41.82597
## motivation       126.15534 152.29466 116.81307  69.28602</code></pre>
<p><br></p>
</div>
<div id="pca" class="section level3">
<h3><span class="header-section-number">5.3.3</span> PCA</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">model_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(scp)</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">d &lt;-<span class="st"> </span>model_svd<span class="op">$</span>d</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">u &lt;-<span class="st"> </span>model_svd<span class="op">$</span>u</a>
<a class="sourceLine" id="cb75-4" data-line-number="4">v &lt;-<span class="st"> </span>model_svd<span class="op">$</span>v</a>
<a class="sourceLine" id="cb75-5" data-line-number="5">eig &lt;-<span class="st"> </span>d<span class="op">^</span><span class="dv">2</span></a></code></pre></div>
<p><br></p>
</div>
<div id="eigenvalue-1" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Eigenvalue</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">eig</a></code></pre></div>
<pre><code>## [1] 233994.01871   2643.18734     60.44796</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">plot_eig</span>(eig)</a></code></pre></div>
<p><img src="Multivariate_Bookdown_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="factor-scores-3" class="section level3">
<h3><span class="header-section-number">5.3.5</span> Factor Scores</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">v <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(d)</a></code></pre></div>
<pre><code>##          [,1]        [,2]      [,3]
## [1,] 259.3939   2.7145460 -3.697377
## [2,] 261.5493 -33.3908501  4.156636
## [3,] 235.5306  -0.1749094 -3.881711
## [4,] 206.9447  38.9979374  3.798954</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(d)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]
## [1,] 417.77812  19.01029  2.663535
## [2,]  59.30769  25.96956 -6.641973
## [3,] 236.51229 -40.09212 -3.039363</code></pre>
<p><br></p>
</div>
<div id="latent-scores-1" class="section level3">
<h3><span class="header-section-number">5.3.6</span> Latent Scores</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">X <span class="op">%*%</span><span class="st"> </span>u <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]
## [1,] -0.7654400 -1.4637130 -0.56896322
## [2,] -0.6834717 -0.6237667  0.32105270
## [3,]  1.1371420  0.8357669 -0.31337608
## [4,]  0.8513383  0.5145176 -0.03000207
## [5,] -0.4608174 -1.1600693 -0.79367985
## [6,]  0.9894445  1.9526936 -0.18849546</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">Y <span class="op">%*%</span><span class="st"> </span>v <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]
## [1,]  0.4841143 -0.7257935  0.96134526
## [2,] -0.2425046  0.7043251 -0.56442103
## [3,]  1.9410240  0.2379724 -0.84734860
## [4,]  1.2353508  0.2546568 -0.10831869
## [5,] -2.2621597 -0.8511297  0.08521605
## [6,]  2.0154595 -0.2686033 -0.03488452</code></pre>
<p><br></p>
</div>
</div>
<div id="math-walk-through-2" class="section level2">
<h2><span class="header-section-number">5.4</span> Math Walk-Through</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="correspondence-analysis-ca.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://https://github.com/juchiyu/MultivarBook/edit/master/Rmd/03-pls.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
